<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Đăng ký tài khoản</title>
    <link rel="stylesheet" th:href="@{/css/register.css}">
    <link href="https://fonts.googleapis.com/css2?family=Inria+Sans:wght@400;700&display=swap" rel="stylesheet">
</head>
<body class="register-page">
<div class="register-wrapper">
    <div class="register-card">
        <h2 class="register-title">Sign up</h2>
        <p><strong>Already have an account?</strong> <a href="/login">Sign in</a></p>

        <form th:action="@{/api/auth/register}" method="post" onsubmit="return validateForm()">
        <div class="form-grid">
                <div class="form-group">
                    <label for="email">Email address</label>
                    <input id="email" name="email" type="text" required placeholder="Email address">
                </div>

                <div class="form-group">
                    <label for="password">Password</label>
                    <div class="password-wrapper">
                        <input id="password" name="password" type="password" required placeholder="Password">
                        <span class="toggle-password" id="togglePassword">
                            <img src="/images/eye_hidepass.png" alt="Toggle password">
                        </span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="fullName">Full name</label>
                    <input id="fullName" name="fullName" type="text" required placeholder="Full name">
                </div>

                <div class="form-group">
                    <label for="role">Role</label>
                    <select id="role" name="role">
                        <option value="">Student</option>
                    </select>
                </div>
            </div>

            <button type="submit">Sign up</button>
            <div id="error-popup" class="popup hidden"></div>
        </form>
    </div>
</div>

<script>
    const togglePassword = document.getElementById('togglePassword');
    const passwordInput = document.getElementById('password');

    togglePassword.addEventListener('click', () => {
        const isHidden = passwordInput.getAttribute('type') === 'password';

        // Đổi type input
        passwordInput.setAttribute('type', isHidden ? 'text' : 'password');

        // Đổi icon
        const img = togglePassword.querySelector('img');
        img.src = isHidden ? '/images/eye_seepass.png' : '/images/eye_hidepass.png';
    });

    function validateForm() {
        const email = document.getElementById('email');
        const password = document.getElementById('password');
        const popup = document.getElementById('error-popup');

        email.classList.remove('error-field');
        password.classList.remove('error-field');
        popup.classList.add('hidden');

        if (!email.value.includes('@')) {
            email.classList.add('error-field');
            popup.textContent = 'Email format is incorrect. Please re-enter.';
            popup.classList.remove('hidden');
            return false;
        }

        if (password.value.length < 8) {
            password.classList.add('error-field');
            popup.textContent = 'Password must be at least 8 characters.';
            popup.classList.remove('hidden');
            return false;
        }

        return true;
    }

    document.querySelectorAll('input, select').forEach(input => {
        input.addEventListener('focus', () => {
            input.classList.remove('error-field');
            document.getElementById('error-popup').classList.add('hidden');
        });
    });
</script>
</body>
</html>
